<div id="box_login">
	<form action="/api/login" method="post">
		<h1 class="h3 mb-3 fw-normal">Por favor, entre.</h1>

		<div class="form-floating">
			<input type="text" class="form-control" id="username" name="user" placeholder="Usuário" required>
			<label for="username">Usuário</label>
		</div>
		<div class="form-floating">
			<input type="password" class="form-control" id="password" name="password" placeholder="Senha" required>
			<label for="password">Senha</label>
		</div>

		<div class="checkbox my-3">
			<label>
				<input type="checkbox" name="remember"> Lembrar-me
			</label>
		</div>
		<button class="w-100 btn btn-lg btn-primary" type="submit">Entrar</button>
	</form>
</div>

<script>
	document.querySelector('form').addEventListener('submit', async e => {
		e.preventDefault()
		const login = e.target[0]
		const senha = e.target[1]
		const keep = e.target[2]

		const Login = await fetch('/api/login', {
			method: 'POST',
			headers: {
				'Content-Type': 'application/json'
			},
			body: JSON.stringify({ login, senha, keep })
		})

		const Response = await Login.json()

		if(Response.auth) {
			localStorage.setItem('token', Response.token)
			window.location.href = '/dashboard'
		} else {
			console.log('Falha na autenticação.')
		}
	})
</script>