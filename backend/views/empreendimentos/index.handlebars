<h2 class="mb-5">Empreendimentos <a href="/dashboard/empreendimentos/create" class="btn btn-primary" role="button" data-bs-toggle="button">Adicionar</a></h2>

<table class="table table-striped table-dark table-hover table-bordered table-sm">
	<thead>
		<tr>
			<td scope="col">Título</td>
			<td scope="col">Preço</td>
			<td scope="col">Status</td>
			<td scope="col">Tipo</td>
			<td scope="col">Cidade</td>
			<td scope="col">Bairro</td>
		</tr>
	</thead>
	<tbody></tbody>
</table>

<script>
	const Empreendimentos = fetch('http://localhost:3001/api/empreendimentos/')
	const Tabela = document.querySelector('tbody')

	Empreendimentos.then(data => {
		data.json().then(empreendimentos => {
			const Result = empreendimentos.map(({ _id, title, price, status, type, cidade, bairro }) => {
				const Status = (status ? 'Online' : 'Offline')
				const Price = `R$ ${price}`
				const Type = t => {
					const tipos = {
						"1": "Casa",
						"2": "Apartamento",
						"3": "Terreno",
						"4": "Kitnet",
					}
					return tipos[t]
				}
				return (`<tr>
					<td><a href="empreendimentos/${_id}" title="Editar empreendimento">${title}</a></td>
					<td>${Price}</td>
					<td>${Status}</td>
					<td>${Type(type)}</td>
					<td>${cidade.name}</td>
					<td>${bairro.name}</td>
				</tr>`)				
			}).join('')
			Tabela.innerHTML += Result
		}).catch(err => console.error(err))
	})
</script>